<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps UI - MD3 Expressive</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Material Design 3 Expressive Theme - Dark Mode */
        :root {
            /* MD3 Color System - Dark Theme */
            --md3-primary: #d0bcff;
            --md3-on-primary: #381e72;
            --md3-primary-container: #4f378b;
            --md3-on-primary-container: #eaddff;
            --md3-secondary: #ccc2dc;
            --md3-on-secondary: #332d41;
            --md3-secondary-container: #4a4458;
            --md3-on-secondary-container: #e8def8;
            --md3-tertiary: #efb8c8;
            --md3-on-tertiary: #492532;
            --md3-tertiary-container: #633b48;
            --md3-on-tertiary-container: #ffd8e4;
            --md3-error: #ffb4ab;
            --md3-on-error: #690005;
            --md3-error-container: #93000a;
            --md3-on-error-container: #ffb4ab;
            --md3-background: #1c1b1f;
            --md3-on-background: #e6e1e5;
            --md3-surface: #1c1b1f;
            --md3-on-surface: #e6e1e5;
            --md3-surface-variant: #49454f;
            --md3-on-surface-variant: #cac4d0;
            --md3-outline: #938f99;
            --md3-outline-variant: #49454f;
            --md3-inverse-surface: #e6e1e5;
            --md3-inverse-on-surface: #313033;
            --md3-inverse-primary: #6750a4;
            
            /* MD3 Elevation - Dark Theme */
            --md3-elevation-1: 0 1px 3px 1px rgba(0, 0, 0, 0.15), 0 1px 2px 0 rgba(0, 0, 0, 0.30);
            --md3-elevation-2: 0 2px 6px 2px rgba(0, 0, 0, 0.15), 0 1px 2px 0 rgba(0, 0, 0, 0.30);
            --md3-elevation-3: 0 4px 8px 3px rgba(0, 0, 0, 0.15), 0 1px 3px 0 rgba(0, 0, 0, 0.30);
            --md3-elevation-4: 0 6px 10px 4px rgba(0, 0, 0, 0.15), 0 2px 4px 0 rgba(0, 0, 0, 0.30);
            --md3-elevation-5: 0 8px 12px 6px rgba(0, 0, 0, 0.15), 0 4px 6px 0 rgba(0, 0, 0, 0.30);
            
            /* MD3 Typography */
            --md3-display-large: 57px;
            --md3-display-medium: 45px;
            --md3-display-small: 36px;
            --md3-headline-large: 32px;
            --md3-headline-medium: 28px;
            --md3-headline-small: 24px;
            --md3-title-large: 22px;
            --md3-title-medium: 16px;
            --md3-title-small: 14px;
            --md3-label-large: 14px;
            --md3-label-medium: 12px;
            --md3-label-small: 11px;
            --md3-body-large: 16px;
            --md3-body-medium: 14px;
            --md3-body-small: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--md3-background);
            color: var(--md3-on-background);
            line-height: 1.5;
            overflow: hidden;
            height: 100vh;
        }

        /* Status Bar */
        .status-bar {
            height: 24px;
            background: var(--md3-background);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
            font-size: 12px;
            font-weight: 500;
            color: var(--md3-on-background);
        }

        .status-left {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-right {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .status-time {
            font-weight: 600;
        }

        .status-signal {
            width: 16px;
            height: 12px;
            background: var(--md3-on-background);
            border-radius: 1px;
            position: relative;
        }

        .status-signal::before {
            content: '';
            position: absolute;
            right: -4px;
            top: 2px;
            width: 2px;
            height: 8px;
            background: var(--md3-on-background);
            border-radius: 1px;
        }

        .status-battery {
            width: 20px;
            height: 10px;
            border: 1px solid var(--md3-on-background);
            border-radius: 2px;
            position: relative;
        }

        .status-battery::after {
            content: '';
            position: absolute;
            right: -3px;
            top: 2px;
            width: 2px;
            height: 6px;
            background: var(--md3-on-background);
            border-radius: 0 1px 1px 0;
        }

        .status-battery::before {
            content: '';
            position: absolute;
            left: 1px;
            top: 1px;
            width: 14px;
            height: 6px;
            background: var(--md3-on-background);
            border-radius: 1px;
        }

        /* Top App Bar */
        .top-app-bar {
            height: 64px;
            background: var(--md3-surface);
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 12px;
            box-shadow: var(--md3-elevation-2);
            position: relative;
            z-index: 1000;
        }

        .search-container {
            flex: 1;
            position: relative;
            max-width: 600px;
        }

        .search-field {
            width: 100%;
            height: 48px;
            background: var(--md3-surface-variant);
            border: none;
            border-radius: 24px;
            padding: 0 48px 0 48px;
            font-size: var(--md3-body-large);
            color: var(--md3-on-surface);
            font-family: inherit;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            box-shadow: var(--md3-elevation-1);
        }

        .search-field:focus {
            outline: none;
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            box-shadow: var(--md3-elevation-2);
        }

        .search-field::placeholder {
            color: var(--md3-on-surface-variant);
        }

        .search-leading-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--md3-on-surface-variant);
            font-size: 20px;
        }

        .search-trailing-icons {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 4px;
        }

        .search-icon-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: var(--md3-on-surface-variant);
            border-radius: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .search-icon-btn:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
        }

        .search-icon-btn:active {
            transform: scale(0.95);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background: var(--md3-primary);
            color: var(--md3-on-primary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            box-shadow: var(--md3-elevation-1);
        }

        .user-avatar:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            box-shadow: var(--md3-elevation-2);
        }

        .user-avatar:active {
            transform: scale(0.95);
        }

        /* Quick Action Buttons */
        .quick-actions {
            padding: 16px;
            display: flex;
            gap: 12px;
            overflow-x: auto;
            background: var(--md3-surface);
            border-bottom: 1px solid var(--md3-outline-variant);
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .quick-actions::-webkit-scrollbar {
            display: none;
        }

        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 12px 16px;
            background: var(--md3-surface-variant);
            color: var(--md3-on-surface-variant);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            min-width: 64px;
            white-space: nowrap;
            box-shadow: var(--md3-elevation-1);
            position: relative;
            overflow: hidden;
        }

        .quick-action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }

        .quick-action-btn:hover::before {
            width: 100%;
            height: 100%;
        }

        .quick-action-btn:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            transform: translateY(-1px);
            box-shadow: var(--md3-elevation-2);
        }

        .quick-action-btn:active {
            transform: translateY(0);
            box-shadow: var(--md3-elevation-1);
        }

        .quick-action-btn .material-icons {
            font-size: 24px;
            position: relative;
            z-index: 1;
        }

        .quick-action-btn span {
            font-size: var(--md3-label-small);
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* Map Container */
        .map-container {
            flex: 1;
            position: relative;
            background: var(--md3-surface-variant);
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* Floating Map Controls */
        .map-controls {
            position: absolute;
            bottom: 80px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 1000;
        }

        .map-control-btn {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 24px;
            background: var(--md3-surface);
            color: var(--md3-on-surface);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--md3-elevation-3);
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .map-control-btn:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            transform: scale(1.05);
        }

        .map-control-btn .material-icons {
            font-size: 24px;
        }

        /* Current Location Marker */
        .current-location-marker {
            background: var(--md3-primary);
            border: 3px solid var(--md3-surface);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            box-shadow: var(--md3-elevation-2);
            animation: pulse 2s infinite;
            position: relative;
        }

        .current-location-marker::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: var(--md3-on-primary);
            border-radius: 50%;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* POI Markers */
        .poi-marker {
            background: var(--md3-primary);
            color: var(--md3-on-primary);
            border: 2px solid var(--md3-surface);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--md3-elevation-2);
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .poi-marker:hover {
            transform: scale(1.1);
            box-shadow: var(--md3-elevation-3);
        }

        /* Bottom Navigation */
        .bottom-nav {
            height: 80px;
            background: var(--md3-surface);
            display: flex;
            align-items: center;
            justify-content: space-around;
            border-top: 1px solid var(--md3-outline-variant);
            box-shadow: var(--md3-elevation-2);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: var(--md3-on-surface-variant);
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            border-radius: 20px;
        }

        .nav-item.active {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
        }

        .nav-item:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
        }

        .nav-item .material-icons {
            font-size: 24px;
            transition: transform 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .nav-item.active .material-icons {
            transform: scale(1.1);
        }

        .nav-item span {
            font-size: var(--md3-label-small);
            font-weight: 500;
        }

        /* Main Layout */
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* POI Modal */
        .poi-modal {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--md3-surface);
            border-radius: 16px 16px 0 0;
            padding: 24px;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            z-index: 2000;
            box-shadow: var(--md3-elevation-4);
        }

        .poi-modal.show {
            transform: translateY(0);
        }

        .poi-modal::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 32px;
            height: 4px;
            background: var(--md3-outline-variant);
            border-radius: 2px;
        }

        .poi-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            margin-top: 16px;
        }

        .poi-icon {
            width: 48px;
            height: 48px;
            border-radius: 24px;
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--md3-elevation-1);
        }

        .poi-icon .material-icons {
            font-size: 24px;
        }

        .poi-info {
            flex: 1;
        }

        .poi-info h3 {
            font-size: var(--md3-title-large);
            font-weight: 500;
            color: var(--md3-on-surface);
            margin-bottom: 4px;
        }

        .poi-info p {
            font-size: var(--md3-body-medium);
            color: var(--md3-on-surface-variant);
            margin-bottom: 8px;
        }

        .poi-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: var(--md3-body-small);
            color: var(--md3-on-surface-variant);
        }

        .poi-rating .material-icons {
            font-size: 16px;
            color: var(--md3-primary);
        }

        .poi-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .poi-action-btn {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 20px;
            background: var(--md3-primary);
            color: var(--md3-on-primary);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--md3-elevation-1);
        }

        .poi-action-btn:hover {
            background: var(--md3-primary-container);
            color: var(--md3-on-primary-container);
            box-shadow: var(--md3-elevation-2);
        }

        .poi-action-btn:active {
            transform: scale(0.98);
        }

        .poi-action-btn .material-icons {
            font-size: 18px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .quick-actions {
                padding: 12px;
                gap: 8px;
            }

            .quick-action-btn {
                padding: 8px 12px;
                min-width: 56px;
            }

            .quick-action-btn .material-icons {
                font-size: 20px;
            }

            .map-controls {
                bottom: 100px;
                right: 12px;
            }

            .map-control-btn {
                width: 44px;
                height: 44px;
            }
        }

        /* Custom Leaflet Styles */
        .leaflet-container {
            background: var(--md3-surface-variant);
        }

        .leaflet-control-layers {
            background: var(--md3-surface);
            border: 1px solid var(--md3-outline-variant);
            border-radius: 8px;
            box-shadow: var(--md3-elevation-2);
        }

        .leaflet-control-layers-toggle {
            background: var(--md3-surface);
            border: 1px solid var(--md3-outline-variant);
            border-radius: 4px;
        }

        .leaflet-popup-content-wrapper {
            background: var(--md3-surface);
            border-radius: 12px;
            box-shadow: var(--md3-elevation-3);
        }

        .leaflet-popup-content {
            color: var(--md3-on-surface);
            font-family: inherit;
        }

        .leaflet-popup-tip {
            background: var(--md3-surface);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <span class="status-time">9:41</span>
            </div>
            <div class="status-right">
                <div class="status-signal"></div>
                <div class="status-battery"></div>
            </div>
        </div>

        <!-- Top App Bar -->
        <div class="top-app-bar">
            <div class="search-container">
                <span class="material-icons search-leading-icon">search</span>
                <input type="text" class="search-field" placeholder="Search Google Maps" id="searchInput">
                <div class="search-trailing-icons">
                    <button class="search-icon-btn" id="micBtn" title="Voice search">
                        <span class="material-icons">mic</span>
                    </button>
                    <button class="search-icon-btn" id="cameraBtn" title="Visual search">
                        <span class="material-icons">photo_camera</span>
                    </button>
                </div>
            </div>
            <button class="user-avatar" id="userAvatar" title="Profile">
                K
            </button>
        </div>

        <!-- Quick Action Buttons -->
        <div class="quick-actions">
            <button class="quick-action-btn" data-category="home">
                <span class="material-icons">home</span>
                <span>Home</span>
            </button>
            <button class="quick-action-btn" data-category="restaurant">
                <span class="material-icons">restaurant</span>
                <span>Restaurants</span>
            </button>
            <button class="quick-action-btn" data-category="cafe">
                <span class="material-icons">local_cafe</span>
                <span>Coffee</span>
            </button>
            <button class="quick-action-btn" data-category="gas">
                <span class="material-icons">local_gas_station</span>
                <span>Gas</span>
            </button>
            <button class="quick-action-btn" data-category="shopping">
                <span class="material-icons">shopping_cart</span>
                <span>Shopping</span>
            </button>
            <button class="quick-action-btn" data-category="more">
                <span class="material-icons">more_horiz</span>
                <span>More</span>
            </button>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Map Container -->
            <div class="map-container">
                <div id="map"></div>
                
                <!-- Floating Map Controls -->
                <div class="map-controls">
                    <button class="map-control-btn" id="directionsBtn" title="Directions">
                        <span class="material-icons">near_me</span>
                    </button>
                    <button class="map-control-btn" id="layersBtn" title="Map layers">
                        <span class="material-icons">layers</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item active" data-tab="explore">
                <span class="material-icons">explore</span>
                <span>Explore</span>
            </button>
            <button class="nav-item" data-tab="you">
                <span class="material-icons">person_pin</span>
                <span>You</span>
            </button>
            <button class="nav-item" data-tab="contribute">
                <span class="material-icons">add_location_alt</span>
                <span>Contribute</span>
            </button>
        </div>
    </div>

    <!-- POI Modal -->
    <div class="poi-modal" id="poiModal">
        <div class="poi-header">
            <div class="poi-icon">
                <span class="material-icons" id="poiIcon">place</span>
            </div>
            <div class="poi-info">
                <h3 id="poiName">Location Name</h3>
                <p id="poiCategory">Category</p>
                <div class="poi-rating">
                    <span class="material-icons">star</span>
                    <span id="poiRating">4.5</span>
                    <span id="poiReviews">(128 reviews)</span>
                </div>
            </div>
        </div>
        <div class="poi-actions">
            <button class="poi-action-btn" id="directionsAction">
                <span class="material-icons">directions</span>
                Directions
            </button>
            <button class="poi-action-btn" id="saveAction">
                <span class="material-icons">bookmark_border</span>
                Save
            </button>
        </div>
    </div>

    <!-- Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        class GoogleMapsUI {
            constructor() {
                this.map = null;
                this.currentLocationMarker = null;
                this.poiMarkers = [];
                this.currentLocation = null;
                this.activeTab = 'explore';
                
                this.init();
            }

            init() {
                this.initMap();
                this.bindEvents();
                this.getCurrentLocation();
                this.addSamplePOIs();
            }

            initMap() {
                // Initialize map with dark theme
                this.map = L.map('map', {
                    zoomControl: false,
                    attributionControl: false
                }).setView([40.7128, -74.0060], 13);

                // Add dark theme tile layer
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors',
                    maxZoom: 19
                }).addTo(this.map);

                // Add layer control
                const baseMaps = {
                    "Default": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'),
                    "Satellite": L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'),
                    "Terrain": L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png')
                };

                L.control.layers(baseMaps).addTo(this.map);
            }

            bindEvents() {
                // Search functionality
                const searchInput = document.getElementById('searchInput');
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.searchLocation(searchInput.value);
                    }
                });

                // Quick action buttons
                document.querySelectorAll('.quick-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const category = e.currentTarget.dataset.category;
                        this.handleQuickAction(category);
                    });
                });

                // Bottom navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        this.switchTab(e.currentTarget.dataset.tab);
                    });
                });

                // Map controls
                document.getElementById('directionsBtn').addEventListener('click', () => {
                    this.showDirections();
                });

                document.getElementById('layersBtn').addEventListener('click', () => {
                    this.toggleLayers();
                });

                // Map click events
                this.map.on('click', (e) => {
                    this.hidePOIModal();
                });

                // Voice and camera buttons
                document.getElementById('micBtn').addEventListener('click', () => {
                    this.startVoiceSearch();
                });

                document.getElementById('cameraBtn').addEventListener('click', () => {
                    this.startVisualSearch();
                });
            }

            getCurrentLocation() {
                if (!navigator.geolocation) {
                    this.showNotification('Geolocation not supported', 'error');
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        this.currentLocation = [lat, lon];

                        // Remove previous marker
                        if (this.currentLocationMarker) {
                            this.map.removeLayer(this.currentLocationMarker);
                        }

                        // Add current location marker
                        this.currentLocationMarker = L.marker([lat, lon], {
                            icon: L.divIcon({
                                className: 'current-location-marker',
                                iconSize: [20, 20],
                                iconAnchor: [10, 10]
                            })
                        }).addTo(this.map);

                        this.map.setView([lat, lon], 15);
                        this.showNotification('Location found!', 'success');
                    },
                    (error) => {
                        console.error('Geolocation error:', error);
                        this.showNotification('Unable to get location', 'error');
                    }
                );
            }

            async searchLocation(query) {
                if (!query.trim()) return;

                try {
                    const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`);
                    const data = await response.json();

                    if (data.length > 0) {
                        const location = data[0];
                        const lat = parseFloat(location.lat);
                        const lon = parseFloat(location.lon);

                        this.map.setView([lat, lon], 15);
                        this.addPOIMarker([lat, lon], location.display_name, 'search');
                        
                        document.getElementById('searchInput').value = location.display_name;
                    } else {
                        this.showNotification('Location not found', 'error');
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    this.showNotification('Search failed', 'error');
                }
            }

            addSamplePOIs() {
                // Add sample POIs around the map
                const samplePOIs = [
                    { lat: 40.7128, lng: -74.0060, name: 'Times Square', category: 'Tourist Attraction', icon: 'attractions', rating: 4.3, reviews: 45.2 },
                    { lat: 40.7589, lng: -73.9851, name: 'Central Park', category: 'Public Park', icon: 'park', rating: 4.8, reviews: 89.1 },
                    { lat: 40.7484, lng: -73.9857, name: 'Empire State Building', category: 'Tourist Attraction', icon: 'attractions', rating: 4.4, reviews: 67.8 },
                    { lat: 40.7527, lng: -73.9772, name: 'Grand Central Terminal', category: 'Transportation Hub', icon: 'train', rating: 4.6, reviews: 23.4 },
                    { lat: 40.7505, lng: -73.9934, name: 'Vons Supermarket', category: 'Grocery Store', icon: 'shopping_cart', rating: 4.1, reviews: 12.7 },
                    { lat: 40.7510, lng: -73.9930, name: 'Great Clips', category: 'Hair Salon', icon: 'content_cut', rating: 4.2, reviews: 8.9 },
                    { lat: 40.7520, lng: -73.9925, name: 'Public School 123', category: 'Elementary School', icon: 'school', rating: 4.0, reviews: 15.3 },
                    { lat: 40.7530, lng: -73.9915, name: 'Starbucks', category: 'Coffee Shop', icon: 'local_cafe', rating: 4.5, reviews: 34.6 },
                    { lat: 40.7540, lng: -73.9905, name: 'Shell Gas Station', category: 'Gas Station', icon: 'local_gas_station', rating: 3.8, reviews: 5.2 },
                    { lat: 40.7550, lng: -73.9895, name: 'McDonald\'s', category: 'Fast Food Restaurant', icon: 'restaurant', rating: 3.9, reviews: 28.4 }
                ];

                samplePOIs.forEach(poi => {
                    this.addPOIMarker([poi.lat, poi.lng], poi.name, poi.category, poi.icon, poi.rating, poi.reviews);
                });
            }

            addPOIMarker(latlng, name, category, icon = 'place', rating = 4.0, reviews = 10) {
                const marker = L.marker(latlng, {
                    icon: L.divIcon({
                        className: 'poi-marker',
                        html: `<div style="background: var(--md3-primary); color: var(--md3-on-primary); width: 32px; height: 32px; border-radius: 16px; display: flex; align-items: center; justify-content: center; border: 2px solid var(--md3-surface); box-shadow: var(--md3-elevation-2);">
                            <span class="material-icons" style="font-size: 16px;">${icon}</span>
                        </div>`,
                        iconSize: [32, 32],
                        iconAnchor: [16, 16]
                    })
                }).addTo(this.map);

                marker.bindPopup(`<b>${name}</b><br>${category}`, {
                    closeButton: false,
                    className: 'poi-popup'
                });

                marker.on('click', () => {
                    this.showPOIModal(name, category, icon, rating, reviews);
                });

                this.poiMarkers.push(marker);
            }

            showPOIModal(name, category, icon, rating = 4.0, reviews = 10) {
                document.getElementById('poiName').textContent = name;
                document.getElementById('poiCategory').textContent = category;
                document.getElementById('poiIcon').textContent = icon;
                document.getElementById('poiRating').textContent = rating;
                document.getElementById('poiReviews').textContent = `(${reviews}k reviews)`;
                
                const modal = document.getElementById('poiModal');
                modal.classList.add('show');
            }

            hidePOIModal() {
                const modal = document.getElementById('poiModal');
                modal.classList.remove('show');
            }

            handleQuickAction(category) {
                const categoryIcons = {
                    home: 'home',
                    restaurant: 'restaurant',
                    cafe: 'local_cafe',
                    gas: 'local_gas_station',
                    shopping: 'shopping_cart',
                    more: 'more_horiz'
                };

                const categoryNames = {
                    home: 'Home',
                    restaurant: 'Restaurants',
                    cafe: 'Coffee Shops',
                    gas: 'Gas Stations',
                    shopping: 'Shopping',
                    more: 'More Options'
                };

                this.showNotification(`Searching for ${categoryNames[category]}...`, 'info');
                
                // Simulate search for category
                setTimeout(() => {
                    const baseLat = this.currentLocation?.[0] || 40.7128;
                    const baseLng = this.currentLocation?.[1] || -74.0060;
                    
                    this.addPOIMarker(
                        [baseLat + (Math.random() - 0.5) * 0.01, 
                         baseLng + (Math.random() - 0.5) * 0.01],
                        `${categoryNames[category]} nearby`,
                        categoryNames[category],
                        categoryIcons[category],
                        4.0 + Math.random() * 0.5,
                        5 + Math.random() * 50
                    );
                }, 1000);
            }

            switchTab(tab) {
                // Update active tab
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
                
                this.activeTab = tab;
                this.showNotification(`Switched to ${tab} tab`, 'info');
            }

            showDirections() {
                this.showNotification('Directions feature coming soon!', 'info');
            }

            toggleLayers() {
                this.showNotification('Layer control opened', 'info');
            }

            startVoiceSearch() {
                this.showNotification('Voice search coming soon!', 'info');
            }

            startVisualSearch() {
                this.showNotification('Visual search coming soon!', 'info');
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 100px;
                    left: 50%;
                    transform: translateX(-50%);
                    padding: 12px 24px;
                    border-radius: 24px;
                    color: white;
                    font-weight: 500;
                    z-index: 10000;
                    box-shadow: var(--md3-elevation-3);
                    background: ${type === 'success' ? 'var(--md3-primary)' : 
                                type === 'error' ? 'var(--md3-error)' : 'var(--md3-secondary)'};
                `;

                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(-50%) translateY(-20px)';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
            }
        }

        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new GoogleMapsUI();
        });
    </script>
</body>
</html>